<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Categories List</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="css/patternfly.css">
    <link rel="stylesheet" type="text/css" href="css/patternfly-addons.css">

    <script>
        $(document).ready(function() {
            let nameFilter = new URLSearchParams(window.location.search).get("name_filter");

            if (nameFilter) {
                $("#filterByNameBox").val(nameFilter);
            }

            $("#filterBtn").click(function() {
               performSearch();
            });

            $("#filterByNameBox").keypress(function(event) {
               if (event.keyCode == 13) {
                   event.preventDefault();
                   $("#filterBtn").click();
               }
            });

            $("#filterByNameBox").focus();
        });

        function performSearch() {
            let nameFilter = $("#filterByNameBox").val()
            let url = (nameFilter) ? "/?name_filter=" + nameFilter : "/"
            window.location.replace(url)
        }

        function togglePowersExpandCollapse(categoryId) {
            let isExpanded = $("#toggle_expand_collapse_" + categoryId).text() == 'Show less';

            if (isExpanded) {
                $("#toggle_expand_collapse_" + categoryId).text('Show more')
                $("#toggle_powers_" + categoryId).removeClass('pf-m-expanded')
                $("#expand_collapse_button_" + categoryId).attr('aria-expanded', false)
                $("#category_powers_" + categoryId).hide()
            }
            else {
                $("#toggle_expand_collapse_" + categoryId).text('Show less')
                $("#toggle_powers_" + categoryId).addClass('pf-m-expanded')
                $("#expand_collapse_button_" + categoryId).attr('aria-expanded', true)
                $("#category_powers_" + categoryId).show()
            }
        }
    </script>
</head>
<body>
<div class="pf-c-card pf-m-display-lg">
    <div class="pf-c-card__title">Categories</div>
    <div class="pf-c-card__body">
        <div class="pf-c-toolbar">
            <div class="pf-c-toolbar__content">
                <div class="pf-c-toolbar__content-section pf-m-nowrap">
                    <div class="pf-c-toolbar__group pf-m-toggle-group pf-m-show-on-xl">
                        <div class="pf-c-toolbar__item pf-m-search-filter">
                            <div class="pf-c-input-group"
                                    aria-label="search filter"
                                    role="group">
                                <div class="pf-c-search-input">
                                    <div class="pf-c-search-input__bar">
                        <span class="pf-c-search-input__text">
                          <span class="pf-c-search-input__icon">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                          </span>
                          <input class="pf-c-search-input__text-input"
                                 type="text"
                                 id="filterByNameBox"
                                 placeholder="Filter by name"
                                 aria-label="Filter by name"/>
                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pf-c-overflow-menu" id="-overflow-menu">
                        <div class="pf-c-overflow-menu__content pf-u-display-none pf-u-display-flex-on-lg">
                            <div class="pf-c-overflow-menu__group pf-m-button-group">
                                <div class="pf-c-overflow-menu__item">
                                    <button class="pf-c-button pf-m-primary" id="filterBtn"
                                            type="button">Filter Categories</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <table
                class="pf-c-table pf-m-grid-md pf-m-sticky-header pf-m-striped"
                role="grid"
                aria-label="Categories table"
                id="categories-table">
            <thead>
            <tr role="rowheader">
                <th role="columnheader" scope="col">ID</th>
                <th role="columnheader" scope="col">Name</th>
                <th class="pf-m-wrap" role="columnheader" scope="col">Description</th>
            </tr>
            </thead>

            <tbody role="rowgroup">
            {#for category in categories}
                <tr role="row">
                <td role="cell" data-label="ID">{category.id}</td>
                <td role="cell" data-label="Name">{category.name}</td>
                <td role="cell" data-label="Description">{category.description}</td>
                </tr>
            {/for}
            </tbody>
        </table>
    </div>
</body>
